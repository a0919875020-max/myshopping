<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>管理員後台</title>
    <style>
    body { font-family: Arial; background: #fff; color: #222; }
    .container { max-width: 900px; margin: 40px auto; background: #fff; color: #222; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px #ccc; }
    h1, h2 { color: #222; }
        form { margin-bottom: 30px; }
        .form-group { margin-bottom: 15px; }
    input, select, textarea { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; background: #fff; color: #222; }
    button { padding: 8px 16px; background: #4CAF50; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    .category-title { margin-top: 30px; font-size: 1.2em; color: #4CAF50; }
        .product-list { list-style: none; padding: 0; }
    .product-item { display: flex; align-items: center; margin-bottom: 18px; background: #f9f9f9; border-radius: 6px; padding: 10px; }
        .product-item img { width: 80px; height: 80px; object-fit: cover; border-radius: 6px; margin-right: 16px; }
        .product-info { flex: 1; }
        .product-actions { display: flex; gap: 8px; }
        .delete-button { background: #e53935; }
        .edit-button { background: #2196F3; }
        .category-nav { margin-bottom: 20px; }
    .category-btn { background: #f1f1f1; border: 1px solid #ccc; color: #333; border-radius: 4px; padding: 10px 15px; cursor: pointer; }
    .category-btn.active { background: #4CAF50; color: #fff; }
        #igBtn {
            position: fixed;
            right: 18px;
            bottom: 80px;
            z-index: 9999;
            background: none;
            border-radius: 0;
            box-shadow: none;
            padding: 0;
            opacity: 1;
            transition: opacity 0.2s;
        }
        #igBtn:hover { opacity: 0.8; }
        @media (max-width:600px) {
            #igBtn { right: 10px; bottom: 56px; width:32px; height:32px; }
            #igBtn img { width:32px; height:32px; }
        }
    </style>
</head>
<body>
    <!-- 主導覽列 -->
    <nav class="navbar">
    <div class="nav-logo"><a href="{{ url_for('index') }}">牧咣</a></div>
        <div class="nav-links nav-center">
            <a href="{{ url_for('index') }}">首頁</a>
            <a href="{{ url_for('category_page', category='水晶') }}">水晶</a>
            <a href="{{ url_for('category_page', category='銀飾') }}">銀飾</a>
            <a href="{{ url_for('category_page', category='戒指') }}">戒指</a>
            <a href="{{ url_for('category_page', category='耳環') }}">耳環</a>
            <a href="{{ url_for('admin') }}">管理員後台</a>
            <a href="{{ url_for('admin_logout') }}">登出</a>
        </div>
    </nav>
    <div style="margin-bottom:24px; text-align:right;">
        <a href="{{ url_for('admin_points') }}" style="background:#4CAF50; color:#fff; padding:8px 18px; border-radius:24px; text-decoration:none; font-weight:bold; box-shadow:0 2px 8px #bbb;">點數管理</a>
    </div>
    <style>
        .navbar { width:100%; background:#fff; box-shadow:0 2px 8px #eee; display:flex; align-items:center; justify-content:space-between; padding:0 32px; height:60px; position:sticky; top:0; z-index:100; }
    .nav-logo a { font-size:1.5em; font-weight:bold; color:#bbb; text-decoration:none; letter-spacing:2px; }
        .nav-links a { margin-left:24px; color:#333; text-decoration:none; font-size:1.1em; transition:color 0.2s; }
        .nav-links a:hover { color:#4CAF50; }
        .container { max-width:900px; margin:40px auto; background:#fff; padding:30px; border-radius:8px; box-shadow:0 2px 8px #ccc; }
        .category-nav { display:flex; gap:18px; margin-bottom:32px; justify-content:center; flex-wrap:wrap; }
        .category-btn { padding:10px 28px; background:#fff; border:2px solid #4CAF50; border-radius:24px; color:#4CAF50; font-size:1.1em; cursor:pointer; transition:all 0.2s; margin-bottom:8px; }
        .category-btn.active, .category-btn:hover { background:#4CAF50; color:#fff; }
        .product-list { list-style:none; padding:0; }
        .product-item { display:flex; align-items:center; margin-bottom:18px; background:#f9f9f9; border-radius:6px; padding:10px; flex-wrap:wrap; }
        .product-item img { width:80px; height:80px; object-fit:cover; border-radius:6px; margin-right:16px; }
        .product-info { flex:1; min-width:160px; }
        .product-actions { display:flex; gap:8px; }
        .delete-button { background:#e53935; }
        .edit-button { background:#2196F3; }
        @media (max-width:900px) {
            .container{padding:12px 4px;}
            .category-nav{gap:8px;}
            .product-item img{width:60px; height:60px;}
        }
        @media (max-width:600px) {
            .navbar{padding:0 8px; height:48px;}
            .nav-logo a{font-size:1.1em;}
            .nav-links a{margin-left:8px; font-size:0.95em;}
            .container{padding:6px 2px;}
            .category-nav{gap:4px;}
            .product-item{flex-direction:column; align-items:flex-start;}
            .product-item img{margin-bottom:8px; margin-right:0;}
        }
    </style>
    <div class="container">
        <h1>管理員後台</h1>
        <h2>上傳Logo圖片</h2>
        <form action="{{ url_for('upload_logo') }}" method="POST" enctype="multipart/form-data" style="margin-bottom: 30px;">
            <div class="form-group">
                <input type="file" name="logo" accept="image/*" required>
            </div>
            <button type="submit">上傳Logo</button>
        </form>
        <h2>新增商品</h2>
        <form action="{{ url_for('add_product') }}" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <input type="text" name="name" placeholder="商品名稱" required>
            </div>
            <div class="form-group">
                <textarea name="description" placeholder="商品描述" required></textarea>
            </div>
            <div class="form-group">
                <input type="number" name="price" placeholder="商品價格" required step="0.01">
            </div>
            <div class="form-group">
                <label>商品圖片1：</label>
                <input type="file" name="image1" required>
            </div>
            <div class="form-group">
                <label>商品圖片2：</label>
                <input type="file" name="image2">
            </div>
            <div class="form-group">
                <label>商品圖片3：</label>
                <input type="file" name="image3">
            </div>
            <div class="form-group">
                <select name="category" required>
                    <option value="水晶">水晶</option>
                    <option value="銀飾">銀飾</option>
                    <option value="戒指">戒指</option>
                    <option value="耳環">耳環</option>
                </select>
            </div>
            <button type="submit">新增商品</button>
        </form>

        <h2>商品列表</h2>
        <!-- 商品分類切換按鈕與列表 -->
        <div class="category-nav">
            <div style="display:inline-block;position:relative;">
                <button class="category-btn" data-cat="水晶" onclick="showAdminCategory('水晶')">水晶</button>
                <div style="display:inline-block;vertical-align:top;">
                    <button class="category-btn" data-cat="紫水晶" onclick="showAdminCategory('紫水晶')" style="margin-left:4px;">紫水晶</button>
                    <button class="category-btn" data-cat="月光石" onclick="showAdminCategory('月光石')" style="margin-left:4px;">月光石</button>
                    <button class="category-btn" data-cat="拉長石" onclick="showAdminCategory('拉長石')" style="margin-left:4px;">拉長石</button>
                </div>
            </div>
            <button class="category-btn" data-cat="銀飾" onclick="showAdminCategory('銀飾')">銀飾</button>
            <button class="category-btn" data-cat="戒指" onclick="showAdminCategory('戒指')">戒指</button>
            <button class="category-btn" data-cat="耳環" onclick="showAdminCategory('耳環')">耳環</button>
        </div>
        {% for category in ['水晶', '銀飾', '戒指', '耳環'] %}
            <ul class="product-list" data-cat="{{ category }}" style="display:none;">
                {% for idx, product in enumerate(products) %}
                    {% if product['category'] == category %}
                        <li class="product-item">
                            {% for img in product['images'] %}
                                <img src="{{ url_for('static', filename=img.replace('static/', '')) }}" alt="{{ product['name'] }}">
                            {% endfor %}
                            <div class="product-info">
                                <strong>{{ product['name'] }}</strong><br>
                                {{ product['description'] }}<br>
                                <span style="color:#4CAF50;">${{ product['price'] }}</span>
                            </div>
                            <div class="product-actions">
                                <a href="{{ url_for('edit_product', product_id=idx) }}">
                                    <button type="button" class="edit-button">編輯</button>
                                </a>
                                <form action="{{ url_for('delete_product', product_id=idx) }}" method="GET" style="display:inline;">
                                    <button type="submit" class="delete-button">刪除</button>
                                </form>
                            </div>
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
        {% endfor %}
        <script>
            function showAdminCategory(cat) {
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.cat === cat);
                });
                document.querySelectorAll('.product-list').forEach(list => {
                    list.style.display = (list.dataset.cat === cat) ? 'block' : 'none';
                });
            }
            window.onload = function() {
                showAdminCategory('水晶');
            }
        </script>
        <div style="text-align:right; margin-top:30px;">
            <a href="{{ url_for('admin_logout') }}" style="color:#e53935;">登出</a>
        </div>
    </div>
    <a id="igBtn" href="https://www.instagram.com/moolight_studio?igsh=Y3Yzb3hsN2Rnczk2" target="_blank" title="Instagram">
        <img src="https://cdn-icons-png.flaticon.com/512/87/87390.png" alt="IG" style="width:40px;height:40px;filter: brightness(0) invert(1);">
    </a>
    <footer style="width:100%;text-align:center;margin:32px 0 0 0;font-size:1em;color:#888;line-height:1.7;">
    2025 © moolight. ALL RIGHTS RESERVED.<br>
    營業人名稱：牧盈工作室  /  統一編號：95247812
    </footer>
</body>
</html>